local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local VirtualUser = game:GetService("VirtualUser")

local localPlayer = Players.LocalPlayer
local camera = Workspace.CurrentCamera
local FOVring

-- Ø«Ø¨Ø§Øª Ù…Ø±ÙŠØ¶ ÙˆÙ‚ÙˆÙŠ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)
local AIM_LOCK_STRENGTH = 999999999  -- Ù‚ÙˆØ© ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø¯Ù (Ù…Ù‡ÙˆÙ„Ø©)

-- ÙØ­Øµ Ø§Ù„Ø¹Ø¯Ùˆ
local function isEnemy(player)
	local s = getgenv().settings
	if not s then return false end
	return not s.teamCheck or player.Team ~= localPlayer.Team
end

-- ÙØ­Øµ Ø§Ù„Ø­ÙŠØ§Ø©
local function isAlive(player)
	local c = player.Character
	return c and c:FindFirstChild("Humanoid") and c.Humanoid.Health > 0
end

-- ÙØ­Øµ Ø§Ù„Ø±Ø¤ÙŠØ©
local function isVisible(part)
	local s = getgenv().settings
	if not s then return false end
	if not s.wallCheck then return true end
	local origin = camera.CFrame.Position
	local dir = part.Position - origin
	local params = RaycastParams.new()
	params.FilterDescendantsInstances = {localPlayer.Character}
	params.FilterType = Enum.RaycastFilterType.Blacklist
	local result = Workspace:Raycast(origin, dir, params)
	return not result
end

-- Ø¯Ø§Ø®Ù„ Ø§Ù„ÙÙˆÙ
local function inFov(pos)
	local s = getgenv().settings
	if not s then return false end
	local screenPos, vis = camera:WorldToViewportPoint(pos)
	if not vis then return false end
	local dist = (Vector2.new(screenPos.X, screenPos.Y) - camera.ViewportSize/2).Magnitude
	return dist <= (s.fov or 100)
end

-- ØªÙ†Ø¨Ø¤ Ø´Ø¯ÙŠØ¯ (Ø«Ø¨Ø§Øª Ù…Ø±ÙŠØ¶)
local function predict(part)
	local s = getgenv().settings
	if not s then return part.Position end
	if s.enable_prediction then
		return part.Position + (part.Velocity or Vector3.zero) * (s.predictionFactor or 0.20)
	end
	return part.Position
end

-- Ø£Ù‚Ø±Ø¨ Ø¹Ø¯Ùˆ
local function getClosestEnemy()
	local s = getgenv().settings
	if not s then return nil end
	local closest, minDist = nil, math.huge
	for _, p in ipairs(Players:GetPlayers()) do
		if p ~= localPlayer and isEnemy(p) and isAlive(p) then
			local char = p.Character
			local part = char and char:FindFirstChild(s.aimbot_target_part or "Head")
			if part and isVisible(part) and inFov(part.Position) then
				local screenPos, visible = camera:WorldToViewportPoint(part.Position)
				if visible then
					local dist = (Vector2.new(screenPos.X, screenPos.Y) - camera.ViewportSize/2).Magnitude
					if dist < minDist then
						minDist = dist
						closest = part
					end
				end
			end
		end
	end
	return closest
end

-- ğŸ”¥ğŸ”¥ Ø«Ø¨Ø§Øª Ø´Ø¯ÙŠØ¯ â€” Ø¨Ø¯ÙˆÙ† Ø³Ù…ÙˆØ« â€” Ø¨Ø¯ÙˆÙ† Ø§Ù‡ØªØ²Ø§Ø² â€” Ø§Ù„ØªØµØ§Ù‚ Ù‚ÙˆÙŠ
RunService.Heartbeat:Connect(function()
	local s = getgenv().settings
	if not s or not s.enable_aimbot then return end

	local target = getClosestEnemy()
	if target then
		local aim = predict(target)

		-- ğŸ”¥ğŸ”¥ğŸ”¥ Ø§Ù„Ø«Ø¨Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶:
		-- Ø§Ø³ØªØ®Ø¯Ø§Ù… CFrame.lookAt Ø¨Ù‚ÙˆØ© Ù…Ø¶Ø§Ø¹ÙØ© (ÙƒØ§Ù…ÙŠØ±Ø§ ØªÙ„ØµÙ‚ Ø¨Ø§Ù„Ù‡Ø¯Ù Ù„Ø²Ù‚Ø© Ù…Ø¬Ù†ÙˆÙ†Ø©)
		local camPos = camera.CFrame.Position
		local locked = CFrame.lookAt(camPos, aim)

		-- Ø­Ù‚Ù† Ø§Ù„Ø«Ø¨Ø§Øª Ø¨Ø¯ÙˆÙ† Ø³Ù…ÙˆØ«:
		camera.CFrame = camera.CFrame:Lerp(locked, 1) -- 1 = Ø¨Ø¯ÙˆÙ† Ù…Ø²Ø­ØŒ Ø¨Ø¯ÙˆÙ† Ø§Ù†Ø²Ù„Ø§Ù‚ØŒ Ø¨Ø¯ÙˆÙ† Ø±Ø­Ù…Ø©

		if s.enable_autoattack then
			VirtualUser:Button1Down(Vector2.zero, camera.CFrame)
			VirtualUser:Button1Up(Vector2.zero, camera.CFrame)
		end
	end
end)

print("[xxxxxTheFox | Aimbot] ğŸ”¥ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø«Ø¨Ø§Øª Ø§Ù„Ù…ÙØ±ÙØ¶ÙŠ!!")
